<!DOCTYPE HTML>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="Truong Ho and Huu Quoc">

    <title>E-Flower Shop</title>

    <!-- ========================= KHAI BÁO BỘ THƯ VIỆN GIAO DIỆN Bootstrap ecommerce - UI Kit ========================= -->
    <link rel="shortcut icon" type="image/x-icon" href="Thu_vien_UI_Kit/images/favicon.ico">

    <!-- jQuery UI kit -->
    <script src="Thu_vien_UI_Kit/js/jquery-2.0.0.min.js" type="text/javascript"></script>

    <!-- Bootstrap4 files UI kit-->
    <script src="Thu_vien_UI_Kit/js/bootstrap.bundle.min.js" type="text/javascript"></script>
    <link href="Thu_vien_UI_Kit/css/bootstrap.css" rel="stylesheet" type="text/css" />

    <!-- Font awesome 5 UI kit -->
    <link href="Thu_vien_UI_Kit/fonts/fontawesome/css/fontawesome-all.min.css" type="text/css" rel="stylesheet">

    <!-- plugin: owl carousel UI kit -->
    <link href="Thu_vien_UI_Kit/plugins/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet">
    <link href="Thu_vien_UI_Kit/plugins/owlcarousel/assets/owl.theme.default.css" rel="stylesheet">
    <script src="Thu_vien_UI_Kit/plugins/owlcarousel/owl.carousel.min.js"></script>

    <!-- custom style -->
    <link href="Thu_vien_UI_Kit/css/ui.css" rel="stylesheet" type="text/css" />
    <link href="Thu_vien_UI_Kit/css/responsive.css" rel="stylesheet" media="only screen and (max-width: 1200px)" />

    <!-- custom javascript UI kit -->
    <script src="Thu_vien_UI_Kit/js/script.js" type="text/javascript"></script>

    <!-- Animate.css by Daniel Eden -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css">
    <!-- mouse0270-bootstrap-notify-->
    <script src="Thu_vien_UI_Kit/bootstrap-notify-3.1.5/bootstrap-notify.js" type="text/javascript"></script>

    <script type="text/javascript">
        /// some script
        // jquery ready start
        $(document).ready(function () {
            // jQuery code
        });
// jquery end
    </script>
</head>

<body>
    <!-- ========================= SECTION HEADER ========================= -->
    <header class="section-header">
        <nav class="navbar navbar-expand-lg navbar-light">
            <div class="container">
                <a class="navbar-brand" id="Th_logo" href="MH_Danh_sach_Hoa.html"><img class="logo" src="" alt="logo E-Flower shop"
                        title="logo E-Flower shop"></a>
                <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTop"
                    aria-controls="navbarTop" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <div class="collapse navbar-collapse" id="navbarTop">
                    <ul class="navbar-nav mr-auto">
                        <li class="nav-item dropdown"><a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">
                                Dịch vụ của chúng tôi </a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#">Dịch vụ giao hàng</a></li>
                                <li><a class="dropdown-item" href="#">Dịch vụ đặt hoa theo yêu cầu</a></li>
                            </ul>
                        </li>
                        <li class="nav-item dropdown"><a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">
                                Liên hệ với chúng tôi</a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#">Trung tâm hỗ trợ khách hàng</a></li>
                                <li><a class="dropdown-item" href="#">Nộp đơn tuyển dụng</a></li>
                            </ul>
                        </li>
                    </ul>
                    </ul>
                    <ul class="navbar-nav">
                        <li class="nav-item">
                            <a href="#" class="btn  btn-outline-success"> <i class="fa fa-phone-volume"></i> Đặt hàng
                                nhanh:
                                <strong><span id="Th_Dienthoai_top">[?????]</span></strong>
                            </a>
                        </li>
                    </ul> <!-- navbar-nav.// -->
                </div> <!-- collapse.// -->
            </div>
        </nav>

        <section class="header-main shadow-sm">
            <div class="container">
                <div class="row-sm align-items-center">
                    <div class="col-lg-4-24 col-sm-3">
                        <div class="category-wrap dropdown py-1">
                            <button type="button" class="btn btn-light  dropdown-toggle" data-toggle="dropdown"><i
                                    class="fa fa-bars"></i>
                                Danh mục sản phẩm</button>
                            <div class="dropdown-menu">
                                <a class="dropdown-item" href="#">Hoa tình yêu</a>
                                <a class="dropdown-item" href="#">Tặng thầy cô </a>
                                <a class="dropdown-item" href="#">Chúc mừng tốt nghiệp</a>
                                <a class="dropdown-item" href="#">Chúc mừng sinh nhật</a>
                                <a class="dropdown-item" href="#">Chia buồn</a>

                            </div>
                        </div>
                    </div>
                    <div class="col-lg-11-24 col-sm-8">
                        <form action="#" class="py-1">
                            <div class="input-group w-100">
                                <select class="custom-select" name="category_name">
                                    <option value="">All type</option>
                                    <option value="">Special</option>
                                    <option value="">Only best</option>
                                    <option value="">Latest</option>
                                </select>
                                <input type="text" class="form-control" style="width:50%;" placeholder="Tìm sản phẩm mong muốn">
                                <div class="input-group-append">
                                    <button style="background-color:#e92f9f;" class="btn text-white" type="submit">
                                        <i class="fa fa-search text-white"></i> Tìm kiếm
                                    </button>
                                </div>
                            </div>
                        </form> <!-- search-wrap .end// -->
                    </div> <!-- col.// -->
                    <div class="col-lg-9-24 col-sm-12">
                        <div class="widgets-wrap float-right row no-gutters py-1">
                            <div class="col-auto">
                                <div class="widget-header dropdown">
                                    <a href="#" data-toggle="dropdown" data-offset="20,10">
                                        <div class="icontext">
                                            <div class="icon-wrap"><i class="text-success icon-sm fa fa-user"></i></div>
                                            <div class="text-wrap text-dark">
                                                Tài khoản <i class="fa fa-caret-down"></i>
                                            </div>
                                        </div>
                                    </a>
                                    <div class="dropdown-menu">
                                        <form class="px-4 py-3">
                                            <div class="form-group">
                                                <label>Địa chỉ email</label>
                                                <input type="email" class="form-control" placeholder="email@example.com">
                                            </div>
                                            <div class="form-group">
                                                <label>Mật khẩu</label>
                                                <input type="password" class="form-control" placeholder="Password">
                                            </div>
                                            <button type="submit" class="btn btn-primary">Đăng nhập</button>
                                        </form>
                                        <hr class="dropdown-divider">
                                        <a class="dropdown-item" href="#">Đăng ký tài khoản</a>
                                        <a class="dropdown-item" href="#">Quên mật khẩu?</a>
                                    </div> <!--  dropdown-menu .// -->
                                </div> <!-- widget-header .// -->
                            </div> <!-- col.// -->

                            <div class="col-auto">
                                <a href="MH_Gio_hang.html" class="widget-header">
                                    <div class="icontext">
                                        <div class="icon-wrap"><i class="text-success icon-sm fa fa-shopping-cart"></i>
                                            <span id="Th_Gio_hang_So_luong_SP" class="notify">0</span></div>
                                        <div class="text-wrap text-dark">
                                            <div>Giỏ hàng</div>
                                        </div>
                                    </div>
                                </a>
                            </div> <!-- col.// -->
                        </div> <!-- widgets-wrap.// row.// -->
                    </div> <!-- col.// -->
                </div> <!-- row.// -->
            </div> <!-- container.// -->
        </section> <!-- header-main .// -->
    </header> <!-- section-header.// -->
    <!-- ========================= SECTION HEADER END// ========================= -->


    <!-- ========================= SECTION CONTENT ========================= -->
    <section class="section-content bg padding-y border-top">
        <div class="container">

            <div id="Th_Card_Danh_sach" class="row">
                <main class="col-sm-9">

                    <div class="card">
                        <table class="table table-hover shopping-cart-wrap">
                            <!-- ========================= Tiêu đề bảng danh sách sản phẩm ========================= -->
                            <thead class="text-muted">
                                <tr>
                                    <th scope="col" width="40%">Sản phẩm</th>
                                    <th scope="col" class="text-right" width="10%">Số lượng</th>
                                    <th scope="col" class="text-right" width="30%">Đơn giá</th>
                                    <th scope="col" class="text-right" width="20%">Lựa chọn</th>
                                </tr>
                            </thead>
                            <!-- =========================  Danh sách sản phẩm ========================= -->
                            <tbody id="Th_Danh_sach_SP_trong_Gio_hang">

                            </tbody>
                        </table>
                    </div> <!-- card.// -->
                </main> <!-- col.// -->




                <!-- ===============Thông tin thanh toán========-->
                <aside class="col-sm-3">
                    <p class="alert alert-success"> <strong>Lưu ý: </strong> Đơn hàng trên 500.000đ được miễn phí giao
                        hàng trong nội thành TP. Hồ Chí Minh. </p>
                    <dl class="dlist-align small">
                        <dt>Giá gốc: </dt>
                        <dd class="text-right">2.000.000 ₫</dd>
                    </dl>
                    <dl class="dlist-align small">
                        <dt>Giảm giá:</dt>
                        <dd class="text-right">500.000 ₫</dd>
                    </dl>
                    <dl class="dlist-align h6">
                        <dt>Thành tiền:</dt>
                        <dd class="text-right text-danger"><strong>1.500.000 ₫</strong></dd>
                    </dl>
                    <dl>
                        <a href="MH_Thanh_toan.html" class="btn btn-danger col-sm-12">Tiến hành đặt hàng</a>
                    </dl>
                    <hr>
                    <figure class="itemside mb-3">
                        <aside class="aside"><img src="Thu_vien_UI_Kit/images/icons/pay-visa.png"></aside>
                        <div class="text-wrap small text-muted">
                            Tiết kiệm ngay 5% khi sử dụng thẻ thanh toán VISA.
                        </div>
                    </figure>
                    <figure class="itemside mb-3">
                        <aside class="aside"> <img src="Thu_vien_UI_Kit/images/icons/pay-mastercard.png"> </aside>
                        <div class="text-wrap small text-muted">
                            Nhận ưu đãi và quà tặng khi thành toán qua MasterCard.
                        </div>
                    </figure>

                </aside> <!-- col.// -->
            </div>

        </div> <!-- container .//  -->
    </section>
    <!-- ========================= SECTION CONTENT END// ========================= -->





    <!-- ========================= SECTION SUBSCRIBE ========================= -->
    <section class="section-subscribe bg-secondary padding-y-lg">
        <div class="container">

            <p class="pb-2 text-center white">Nhận thông tin khuyến mãi mới nhất từ chúng tôi</p>

            <div class="row justify-content-md-center">
                <div class="col-lg-4 col-sm-6">
                    <form class="row-sm form-noborder">
                        <div class="col-8">
                            <input class="form-control" placeholder="Email của bạn" type="email">
                        </div> <!-- col.// -->
                        <div class="col-4">
                            <button type="submit" class="btn btn-block btn-warning"> <i class="fa fa-envelope"></i>
                                Theo dõi </button>
                        </div> <!-- col.// -->
                    </form>
                    <small class="form-text text-white-50">Chúng tôi cam kết bảo mật thông tin của bạn</small>
                </div> <!-- col-md-6.// -->
            </div>


        </div> <!-- container // -->
    </section>
    <!-- ========================= SECTION SUBSCRIBE END.//========================= -->

    <!-- ========================= FOOTER ========================= -->
    <footer class="section-footer bg-secondary">
        <div class="container">
            <section class="footer-top padding-top">
                <div class="row">
                    <aside class="col-sm-3 col-md-3 white">
                        <h5 class="title">HỖ TRỢ KHÁCH HÀNG </h5>
                        <ul class="list-unstyled">
                            <li> <a href="#">Trung tâm hỗ trợ khách hàng</a></li>
                            <li><a href="#">Dịch vụ giao hàng</a></li>
                            <li><a href="#">Dịch vụ đặt hoa theo yêu cầu</a></li>
                            <li> <a href="#">Gửi yêu cầu hỗ trợ</a></li>
                            <li> <a href="#">Chính sách đổi trả</a></li>
                        </ul>
                    </aside>
                    <aside class="col-sm-3  col-md-3 white">
                        <h5 class="title">DANH SÁCH CỬA HÀNG</h5>
                        <ul class="list-unstyled">
                            <li> <a href="#"> Chi nhánh Quận 1, TP.HCM</a></li>
                            <li> <a href="#"> Chi nhánh Quận 3, TP.HCM</a></li>
                            <li> <a href="#"> Chi nhánh Quận 5, TP.HCM</a></li>
                            <li> <a href="#"> Chi nhánh Hoàn Kiếm, Hà Nội</a></li>

                        </ul>
                    </aside>
                    <aside class="col-sm-3  col-md-3 white">
                        <h5 class="title">PHƯƠNG THỨC THANH TOÁN</h5>
                        <ul class="list-unstyled">
                            <li><img src="Thu_vien_UI_Kit/images/icons/pay-visa.png">
                                <img src="Thu_vien_UI_Kit/images/icons/pay-visa-el.png">
                                <img src="Thu_vien_UI_Kit/images/icons/pay-mastercard.png">
                                <img src="Thu_vien_UI_Kit/images/icons/pay-american-ex.png">
                            </li>

                            <li> <a href="#"> Phương thức chuyển tiền</a></li>
                            <li> <a href="#"> Giấy phép kinh doanh</a></li>
                        </ul>
                    </aside>
                    <aside class="col-sm-3">
                        <article class="white">
                            <h5 class="title">LIÊN HỆ</h5>
                            <p>
                                <a id="Th_Ten_Cuahang">[?????]</a><br>
                                Địa chỉ: <a id="Th_Dia_chi">[?????]</a><br>
                                Số điện thoại: <a id="Th_Dienthoai_bot">[?????]</a><br>
                            </p>

                            <div class="btn-group white">
                                <a class="btn btn-facebook" title="Facebook" target="_blank" href="#"><i class="fab fa-facebook-f  fa-fw"></i></a>
                                <a class="btn btn-instagram" title="Instagram" target="_blank" href="#"><i class="fab fa-instagram  fa-fw"></i></a>
                                <a class="btn btn-youtube" title="Youtube" target="_blank" href="#"><i class="fab fa-youtube  fa-fw"></i></a>
                                <a class="btn btn-twitter" title="Twitter" target="_blank" href="#"><i class="fab fa-twitter  fa-fw"></i></a>
                            </div>
                        </article>
                    </aside>
                </div> <!-- row.// -->
                <br>
            </section>
            <section class="footer-bottom row border-top-white">
                <div class="col-sm-6">
                    <p class="text-white-50">Phiển triển bởi <strong> Truong Ho</strong> & <strong>Huu Quoc</strong></p>
                </div>
                <div class="col-sm-6">
                    <p class="text-md-right text-white-50">
                        Copyright 2018, E-Flower Team</a>
                    </p>
                </div>
            </section> <!-- //footer-top -->
        </div><!-- //container -->
    </footer>
    <!-- ========================= FOOTER END // ========================= -->





    <!-- ********************************* LIÊN KẾT TẬP TIN JAVASCRIPT ********************-->
    <script src="../Xu_ly/Xu_ly_3L.js"></script>


    <!-- **********************************  XỬ LÝ JAVASCRIPT ****************************-->
    <script>

        //*********** Xuất dữ liệu dữ liệu hoa, thông tin cửa hàng ***********
        // Đọc tất cả Dữ liệu lưu trữ
        var Du_lieu = Doc_Du_lieu();
        // Gán biến Danh_sach_Hoa
        var Danh_sach_Hoa = Du_lieu.Danh_sach_Hoa
        // Gán biến Cua_hang
        var Cua_hang = Du_lieu.Cua_hang
        //Kiểm tra kết quả tất cả dữ liệu trả về
        console.log(Du_lieu)
        //Thực hiện xuất thông tin cửa hàng
        Xuat_Thong_tin_Cua_hang(Cua_hang, Th_Ten_Cuahang, Th_Dia_chi, Th_Dienthoai_top, Th_Dienthoai_bot, Th_logo)


        //*********** Xuất số lượng sản phẩm cho Giỏ hàng -đọc từ Session Storage ***********
        if (sessionStorage.getItem("Danh_sach_Chon") != undefined) {
            var ds = JSON.parse(sessionStorage.getItem("Danh_sach_Chon")) //chuyển chuỗi trong Item của Session Storage về Object
            var So_luong_SP = ds.length // Đếm số đối tượng
            Th_Gio_hang_So_luong_SP.innerHTML = `<u>${So_luong_SP}</u>` //xuất số lượng sp lên icon giỏ hàng
        }


        //************ Xuất danh sách sản phẩm trong Giỏ hàng
        var Danh_sach_Cap_nhat = []
        Danh_sach_Chon = JSON.parse(sessionStorage.getItem("Danh_sach_Chon"))

        if (Danh_sach_Chon != null) {
            Danh_sach_Chon.forEach(ten_ma_so => {
                var Hoa_tuoi = Danh_sach_Hoa.find(x => x.Ma_so == ten_ma_so)
                Danh_sach_Cap_nhat.push(Hoa_tuoi)
            })
            //Xuất danh sách sản phẩm trong giỏ hàng
            Xuat_Danh_sach_San_pham_mua(Danh_sach_Cap_nhat, Th_Danh_sach_SP_trong_Gio_hang)

        } else {
            //Xuất danh sách rỗng
            Th_Card_Danh_sach.innerHTML = `      
            <main class="col-sm-9 align-items-center justify-content-center">
                <div class="card align-items-center justify-content-center">
                    <table class="table table-hover shopping-cart-wrap align-items-center justify-content-center">
                        <tbody>
                            <hr>
                            <tr>
                                Không có sản phẩm nào trong giỏ hàng của bạn.
                            </tr>
                            <hr>
                            <span class="icon-wrap icon-md round mb-2 border">
						            <i class="fa fa-shopping-cart"></i>
					        </span>
                            <hr> 
                            <a href="MH_Danh_sach_Hoa.html" class="btn btn-warning btn col-3">Tiếp tục mua sắm </a>
                            <hr>
                        </tbody>
                    </table>
                </div> <!-- card.// -->
            </main> <!-- col.// -->`
        }



        // Hàm xuất danh sách sản phẩm trong giỏ hàng
        function Xuat_Danh_sach_San_pham_mua(Danh_sach_Mua, Th_Cha) {
            Th_Cha.innerHTML = ""
            var noi_dung_HTML = ``
            console.log(Danh_sach_Mua)
            Danh_sach_Mua.forEach(San_pham_Mua => {
                // Tính toán giá tiền khuyến mãi
                var Gia_goc = San_pham_Mua.Don_gia_Ban  //number
                var Gia_khuyen_mai = Gia_goc - ((Gia_goc) * (San_pham_Mua.Trang_thai.Ti_le_khuyen_mai))  //number
                var Phan_tram_KM = San_pham_Mua.Trang_thai.Ti_le_khuyen_mai * 100
                noi_dung_HTML += `
                    <tr>
                        <td>
                            <figure class="media">
                                <div class="img-wrap"><img src="http://localhost:1001/${San_pham_Mua.Ma_so}.jpg" class="img-thumbnail img-sm"></div>
                                    <figcaption class="media-body">
                                        <h6 class="title text-truncate">${San_pham_Mua.Ten}</h6>
                                        <dl class="dlist-inline small">
                                            <dt>Chủ đề: </dt>
                                            <dd>${San_pham_Mua.Chu_de.Ten}</dd>
                                        </dl>
                                        <dl class="dlist-inline small">
                                            <dt>Màu: </dt>
                                            <dd>${San_pham_Mua.Mau_sac.Ten}</dd>
                                        </dl>
                                    </figcaption>
                                        </figure>
                        </td>
                        <td>
                                <input class="form-control" type="number" min="1" max="10" value="1" id="example-number-input">
                                    </td>
                        <td>`


                if (San_pham_Mua.Trang_thai.Ti_le_khuyen_mai != 0) {
                    noi_dung_HTML +=
                        `<div class="price-wrap text-right">
                                        <dl class="dlist-inline">
                                            <dt>${Tao_Chuoi_The_hien_So_nguyen_duong(Gia_khuyen_mai)} ₫</dt>
                                        </dl>
                                        <dl class="dlist-inline small">
                                            <dd style="text-decoration: line-through">${Tao_Chuoi_The_hien_So_nguyen_duong(Gia_goc)} ₫</dd>
                                        </dl>
                                        <dl class="dlist-inline">
                                            <span class="badge badge-warning">-${Phan_tram_KM} %</span>
                                        </dl>
                                    </div> <!-- price-wrap .// -->
                        </td>
                                <td class="text-right">
                                    <a id="Th_Bo_san_pham_${San_pham_Mua.Ma_so}" href="" class="btn btn-outline-danger"> × Bỏ sản phẩm</a>
                        </td>
                    </tr>`

                } else {
                    noi_dung_HTML +=
                        `<div class="price-wrap text-right">
                                        <dl class="dlist-inline">
                                            <dt>${Tao_Chuoi_The_hien_So_nguyen_duong(Gia_goc)} ₫</dt>
                                        </dl>
                    </div> <!-- price-wrap .// -->
                        </td>
                                <td class="text-right">
                                    <a id="Th_Bo_san_pham_${San_pham_Mua.Ma_so}" href="" class="btn btn-outline-danger"> × Bỏ sản phẩm</a>
                        </td>
                    </tr>`
                }

                //Jquery
                $(document).ready(function () {
                    $(`#Th_Bo_san_pham_` + San_pham_Mua.Ma_so).on("click", function () {

                        var ds = []
                        if (sessionStorage.getItem("Danh_sach_Chon") != undefined) {
                            ds = JSON.parse(sessionStorage.getItem("Danh_sach_Chon"))
                        }
                        var vt = ds.indexOf(San_pham_Mua.Ma_so)
                        ds.splice(vt, 1) // Xóa
                        // alert(San_pham_Mua.Ma_so)
                        if (ds.length > 0) {
                            sessionStorage.setItem("Danh_sach_Chon", JSON.stringify(ds)) // 
                        } else {
                            sessionStorage.removeItem("Danh_sach_Chon") //xóa khỏi danh sách  
                        }
                    });
                });

            })

            //Xuất danh sách hoa
            Th_Cha.innerHTML = noi_dung_HTML
        }
    </script>
    <!-- **************** XỬ LÝ JAVASCRIPT - END //**************** -->
</body>

</html>